{% extends 'backend/base.html' %}
{% load static %}
{% load widget_tweaks %}
{% load crispy_forms_tags %}

{% block title %} Create Product {% endblock %}

{% block page_css %}
<style>
  .error {
    margin-top: 5px;
    color: #5a5c69;
    font-size: 14px !important;
    position: relative;
    line-height: 1;
    width: 12.5rem;
    color: rgb(236, 109, 35) !important;
  }
  .delete-row {
    font-size: 14px !important;
    color: rgb(236, 109, 35) !important;
  }
</style>
{% endblock page_css %}

{% block content %}
<div class="d-sm-flex align-items-center justify-content-between mb-4">
    <h1 class="h3 mb-0 text-gray-800">Create Product</h1>
    <a href="{% url 'product:list.product' %}" class="float-right btn btn-primary">All Product</a>
</div>

<div id="app">
    <section>
      <form action="" method="POSt" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="row">
          <div class="col-md-6">
            <div class="card shadow mb-4">
              <div class="card-body">
                <div class="form-group">
                  <label for="">Product Name</label>
                  {% render_field form.title class+="form-control" placeholder="Product Name"  %}
                </div>
                <div class="form-group">
                  <label for="">Product SKU</label>
                  {% render_field form.sku class+="form-control" placeholder="Product SKU"  %}
                </div>
                <div class="form-group">
                  <label for="">Description</label>
                  {% render_field form.description class+="form-control" placeholder="Product Description" cols="30" rows="4"  %}
                </div>
              </div>
            </div>
    
            <div class="card shadow mb-4">
              <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                <h6 class="m-0 font-weight-bold text-primary">Media</h6>
              </div>
              <div class="card-body border">
                
                  <div class="table-responsiv">
                  
                    <table>
                      <tr>
                        <th>Thumbnail*</th>
                        <th></th>
                      </tr>
                        {{ image_formset.management_form|crispy }}
                        {% for form in image_formset.forms %}
                                <tr class="{% cycle 'row1' 'row2' %} img_formset_row-{{ image_formset.prefix }}">
                                    {% for field in form.visible_fields %}
                                    <td>
                                        {# Include the hidden fields in the form #}
                                        {% if forloop.first %}
                                            {% for hidden in form.hidden_fields %}
                                                {{ hidden }}
                                            {% endfor %}
                                        {% endif %}
                                        
                                        {{ field.errors.as_ul }}
                                        {{ field|as_crispy_field }}
                                    </td>
                                    {% endfor %}
                                </tr>
                        {% endfor %}
                    </table>
                  </div>
              </div>
            </div>
          </div>
    
          <div class="col-md-6">
            <div class="card shadow mb-4">
              <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                <h6 class="m-0 font-weight-bold text-primary">Variants</h6>
              </div>
              <div class="card-body">
                <div class="table-responsiv">
                 
                  <table>
                    <tr>
                      <th>Variant title*</th>
                      <th>Variant*</th>
                      <th>Price*</th>
                      <th>Stock*</th>
                      <th></th>
                    </tr>
                      {{ variant_formset.management_form|crispy }}
                      {% for form in variant_formset.forms %}
                              <tr class="{% cycle 'row1' 'row2' %} formset_row-{{ variant_formset.prefix }}">
                                  {% for field in form.visible_fields %}
                                  <td>
                                      {# Include the hidden fields in the form #}
                                      {% if forloop.first %}
                                          {% for hidden in form.hidden_fields %}
                                              {{ hidden }}
                                          {% endfor %}
                                      {% endif %}
                                      
                                      {{ field.errors.as_ul }}
                                      {{ field|as_crispy_field }}
                                  </td>
                                  {% endfor %}
                              </tr>
                      {% endfor %}
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
    
        <button type="submit" class="btn btn-lg btn-primary">Save</button>
        <button type="button" class="btn btn-secondary btn-lg">Cancel</button>
      </form>
      </section>
</div>
{% endblock %}

{% block page_js %}
<!-- <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script> -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.formset/1.2.2/jquery.formset.min.js" integrity="sha512-ltwjKsDTo3hW/wV66ZaEkf2wOAFxmg7rWM76J8kOcYKLSKy44WBYO/BFaNNH3NGDS8BSz3meB9wtSnm41oL+pA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</script>
<script type="text/javascript">
      $('.img_formset_row-{{ image_formset.prefix }}').formset({
          addText: 'Add another',
          deleteText: 'Remove',
          prefix: '{{ image_formset.prefix }}',
      });


    $('.formset_row-{{ variant_formset.prefix }}').formset({
        addText: 'Add another',
        deleteText: 'Remove',
        prefix: '{{ variant_formset.prefix }}',
    });
</script>
{% endblock page_js %}

